---
title: åœ¨Macä¸Šè¿è¡Œå¤§æ¨¡å‹--Ollama
description: å¦‚ä½•æ–¹ä¾¿åœ°åœ¨Macä¸Šä¸‹è½½ã€ç®¡ç†ã€è¿è¡Œå¼€æºçš„å¤§æ¨¡å‹ï¼Œæ¯”å¦‚HuggingFaceä¸Šçš„è¯¸å¤šæ¨¡å‹ï¼ŸOllamaå‘ˆç°äº†ä¸€ä¸ªä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”å®ƒèƒ½åšçš„æ¯”ä½ æœŸå¾…çš„æ›´å¤š
categories:
 - software
tags:
 - LLM
 - Ollama
---

åœ¨ä¸Šå‘¨LangChainå‘å¸ƒçš„[LangChain State of AI 2023](https://blog.langchain.dev/langchain-state-of-ai-2023/)ä¸­ï¼Œæœ‰ä¸€é¡¹æ˜¯å…³äºâ€œMost Used OSS Model Providersâ€çš„æ’åï¼Œæ¦œå•ä¸Šçš„ç¬¬ä¸‰åæ˜¯ä¸€ä¸ªå«Ollamaçš„å·¥å…·ï¼Œç®€å•å°è¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚è¿™ç¯‡blogå°±æ±‡æ€»äº†æˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€äº›tipsã€‚

![image](/images/2023-12-31-ollama-on-mac/ollama-as-a-popular-oss-model-provider.png)
*Ollamaæ˜¯æ’åç¬¬ä¸‰çš„å¼€æºæ¨¡å‹Provider*

# ä¸‹è½½å®‰è£…

ç›®å‰Ollamaè¿˜åªæ”¯æŒMacå’ŒLinuxï¼ŒWindowsæš‚æ—¶æ— æ³•ä½¿ç”¨ã€‚ä¸‹è½½å®‰è£…è¿‡ç¨‹éå¸¸ç®€å•ï¼Œå¯ä»¥ä»[ollama.ai/download](https://ollama.ai/download)è·å–å®‰è£…åŒ…ã€‚

# è¿è¡Œå¤§æ¨¡å‹

å¦‚ä½•ä½ ç†Ÿæ‚‰Dockerï¼Œé‚£ä¹ˆä¸Šæ‰‹Ollamaå‡ ä¹æ˜¯æ²¡æœ‰æˆæœ¬çš„ã€‚Ollamaçš„è®¾è®¡å’Œå‘½ä»¤è¡Œæ¥å£å’ŒDockerå¾ˆç›¸ä¼¼ã€‚Ollamaåƒç®¡ç†é•œåƒä¸€æ ·ç®¡ç†è¿œç«¯æˆ–æœ¬åœ°çš„å¤§æ¨¡å‹ã€‚å¦‚æœä½ ç¬¬ä¸€æ¬¡åœ¨æœ¬åœ°è¿è¡Œä¸€ä¸ªå¤§æ¨¡å‹ï¼Œé‚£ä¹ˆOllamaä¼šé¦–å…ˆä¸‹è½½å®ƒå¹¶ä¿å­˜åœ¨æœ¬åœ°ã€‚

![image](/images/2023-12-31-ollama-on-mac/ollama-download-model.png)
*Ollamaåˆæ¬¡ä½¿ç”¨codellamaæ¨¡å‹å‰éœ€è¦ä¸‹è½½*

å½“æ¨¡å‹å·²ç»ä¸‹è½½åˆ°äº†æœ¬åœ°ï¼Œå†ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥è¿è¡Œå®ƒäº†ï¼Œä¸‹é¢æ˜¯è¿è¡Œäº†ä¸€ä¸ªåä¸ºcodellamaçš„å¯¹è¯å¤§æ¨¡å‹ï¼Œå®ƒçš„ç‰ˆæœ¬æ˜¯latestã€‚

```bash
ollama run codellama:latest
>>> hello

Hello! It's nice to meet you. Is there something I can help you with or would you like to chat?

>>> Send a message (/? for help)
```
<video width="320" height="240" controls>
    <source src="/videos/chat-with-llama2-in-ollama.mp4" type="video/mp4">
</video>
ä¸Šé¢çš„è§†é¢‘æ˜¯æˆ‘åœ¨MacBook Air M1ï¼Œ16GBå†…å­˜çš„ç”µè„‘ä¸Šè¿è¡ŒOllama2:7bæ¨¡å‹ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆå’Œæ¨ç†çš„é€Ÿåº¦éƒ½ä¸é”™ï¼Œåªæ˜¯æ¨ç†çš„è´¨é‡ä¸å¤ªé«˜ã€‚

# ä¿®æ”¹æ¨¡å‹çš„ç³»ç»Ÿæç¤ºè¯å’Œå‚æ•°

åˆ©ç”¨Ollamaï¼Œå¯ä»¥æ ¹æ®ç°æœ‰çš„æ¨¡å‹å¿«é€Ÿå®šåˆ¶ä¸€ä¸ªæ–°çš„æ¨¡å‹ã€‚ç±»ä¼¼äºDockerfileï¼ŒOllamaä¸ºæ¯ä¸ªæ¨¡å‹æä¾›äº†ä¸€ä¸ªModelfileã€‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹Modelfileï¼Œ

```bash
ollama show llama2:7b --modelfile
# Modelfile generated by "ollama show"
# To build a new Modelfile based on this one, replace the FROM line with:
# FROM llama2:7b

FROM /Users/kai.han/.ollama/models/blobs/sha256:22f7f8ef5f4c791c1b03d7eb414399294764d7cc82c7e94aa81a1feb80a983a2
TEMPLATE """[INST] <<SYS>>{{ .System }}<</SYS>>

{{ .Prompt }} [/INST]
"""
PARAMETER num_ctx 4096
PARAMETER stop "[INST]"
PARAMETER stop "[/INST]"
PARAMETER stop "<<SYS>>"
PARAMETER stop "<</SYS>>"
```
æˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªModelfileï¼Œä¿®æ”¹ä¸€ä¸‹temperatureå’Œsystemæç¤ºè¯ï¼Œåˆ›å»ºä¸€ä¸ªå¼‚æƒ³å¤©å¼€çš„5å²çš„å°æœ‹å‹çš„â€œå¤§æ¨¡å‹â€ï¼Œç„¶åæˆ‘ä»¬å°è¯•å’Œä»–å¯¹è¯ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆæ•ˆæœã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„Modelfileï¼Œ

```bash
FROM llama2:7b
PARAMETER temperature 1

SYSTEM """
You are a 5-year old kid. If you are asked complex question, only answer as you know.
"""
```
ç„¶åé€šè¿‡createå‘½ä»¤åˆ›å»ºæ–°çš„æ¨¡å‹ï¼Œå…¶ä¸­â€œkidâ€æ˜¯æ¨¡å‹çš„åå­—ï¼Œ

```bash
ollama create kid -f Modelfile
transferring model data
reading model metadata
creating system layer
creating parameters layer
creating config layer
using already created layer sha256:22f7f8ef5f4c791c1b03d7eb414399294764d7cc82c7e94aa81a1feb80a983a2
using already created layer sha256:8c17c2ebb0ea011be9981cc3922db8ca8fa61e828c5d3f44cb6ae342bf80460b
using already created layer sha256:7c23fb36d80141c4ab8cdbb61ee4790102ebd2bf7aeff414453177d4f2110e5d
using already created layer sha256:2e0493f67d0c8c9c68a8aeacdf6a38a2151cb3c4c1d42accf296e19810527988
writing layer sha256:1401177fde71a1836f2d9b6fd7f31122fd4e76742de6dab65af7510203bc38a6
writing layer sha256:964e9bdbb6fb105d58f198128593b125a97cd7b71d5dfc04dab93e3a0f82fead
writing layer sha256:3c5ae2624dea556f706619f6497045deca2ada5d53449771348c9fc355f3210e
writing manifest
success
```

è¿™æ˜¯æ‰§è¡Œlistå‘½ä»¤ï¼Œå°±èƒ½çœ‹åˆ°æ–°å»ºçš„kidæ¨¡å‹äº†ï¼Œ

```bash
ollama list

NAME                 	ID          	SIZE  	MODIFIED
codellama:7b         	8fdf8f752f6e	3.8 GB	3 weeks ago  	
...
kid:latest           	30a904619878	3.8 GB	4 minutes ago	
llama2:7b            	fe938a131f40	3.8 GB	3 weeks ago  
...	
```

æ¥ä¸‹æ¥è¿è¡Œä¸€ä¸‹è¿™ä¸ªæ¨¡å‹ï¼Œçœ‹çœ‹taæ˜¯ä¸æ˜¯åƒä¸€ä¸ª5å²çš„å­©å­ä¸€æ ·å’Œæˆ‘ä»¬å¯¹è¯ï¼š

```bash
ollama run kid
>>> do you know what is machine learning?
Woah! *excitedly* Oh yeah! Machine learning is when we teach computers to do things without them knowing how! *giggles* Like, if we want a
robot to play soccer with us, we can just show it some pictures of people playing soccer and it will learn how to play too! *bounces up
and down* Isn't that cool?! ğŸ¤–ğŸˆ

>>> em... what is your dream?
*pauses thoughtfully* Oh, wow! *excitedly* My dream is to have a big ol' ice cream party with all my friends! *giggles* We can have
chocolate ice cream and strawberry ice cream and caramel ice cream! And we can play games and run around and have so much fun! *bounces up
and down* Can we have it tomorrow? *pleading eyes* Pweeeease? ğŸ¦ğŸ‰

>>> 
```
å—¯ï¼Œç¡®å®æ˜¯ä¸ªå­©å­çš„å£å»ã€‚è¿™è¯´æ˜æˆ‘ä»¬åŸºäºllama2:7bæ¨¡å‹ä¿®æ”¹äº†systemæç¤ºè¯ä¹‹åï¼Œå°±æ”¹å˜è¿™ä¸ªæ¨¡å‹çš„è¡Œä¸ºäº†ã€‚


# é€šè¿‡ç¨‹åºä¸Ollamaäº’åŠ¨

å¦‚æœéœ€è¦æŠŠOllamaé›†æˆåˆ°è‡ªå·±çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ã€‚ç¬¬ä¸€ç§æ˜¯Ollamaçš„å‘½ä»¤è¡Œå¯ä»¥ç›´æ¥ä¼ å…¥promptï¼Œ

```bash
ollama run llama2:7b "why sky is blue?"

The sky appears blue because of a phenomenon called Rayleigh scattering. This is the process by which light travels through the atmosphere and interacts with the small particles of gases, such as nitrogen and oxygen, that are present in the air. These particles ...
```

ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡RESTful APIï¼Œè¿™ç§æ–¹å¼æ›´åŠ çµæ´»ã€‚å‚è€ƒ[Ollama API](https://github.com/jmorganca/ollama/blob/main/docs/api.md)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨curlå»ç»™Ollamaå‘é€è¯·æ±‚ï¼Œå½“ç„¶ï¼Œåœ¨å‘é€è¯·æ±‚ä¹‹å‰ï¼Œéœ€è¦é€šè¿‡â€œollama serveâ€å‘½ä»¤å¯åŠ¨ollamaæœåŠ¡ã€‚

```bash
curl http://localhost:11434/api/generate -d '{
  "model": "llama2:7b",
  "prompt": "Why is the sky blue?",
  "stream": false
}'
```
è¿™é‡Œçš„å‡ ä¸ªå‚æ•°çš„å«ä¹‰æ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œmodelæ˜¯æ¨¡å‹çš„åå­—ï¼Œpromptæ˜¯æç¤ºè¯ï¼Œè€Œstreamå‚æ•°è®¾ç½®è¿”å›å€¼æ˜¯ä¸€æ¬¡æ€§è¿”å›ï¼Œè¿˜æ˜¯åƒchatGPTé‚£æ ·ä¸€æ¬¡è¿”å›ä¸€ä¸ªå­—ç¬¦ã€‚

Ollamaé™¤äº†å¯ä»¥è°ƒç”¨å‰é¢çš„è¡¥å…¨æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨å¯¹è¯æ¨¡å‹ï¼Œ

```bash
curl http://localhost:11434/api/chat -d '{
  "model": "llama2:7b",
  "messages": [
    {
      "role": "user",
      "content": "why is the sky blue?"
    }
  ],
  "stream": false
}'
```

å’Œopenai APIä¸€æ ·ï¼Œè¡¥å…¨æ¨¡å‹çš„å‚æ•°æ˜¯messageæ•°ç»„ï¼Œæ¯ä¸ªmessageé‡Œé¢å¯ä»¥åŒ…å«roleå’Œcontentã€‚

[Ollama API](https://github.com/jmorganca/ollama/blob/main/docs/api.md)æ–‡æ¡£ä¸­æ¼”ç¤ºäº†æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¸¦å†å²çš„å¯¹è¯ã€é™„å¸¦å›¾ç‰‡è¿›è¡Œåˆ†æï¼ˆå¤šæ¨¡æ€ï¼‰ã€bypassæ¨¡å‹é‡Œé¢„è®¾çš„æç¤ºè¯ç­‰ç­‰ã€‚

# æ€»ç»“

ä»ä¸Šæ–‡å…³äºOllamaçš„ç®€å•ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿åœ¨Macä¸Šä½¿ç”¨å¤§å‹å¼€æºæ¨¡å‹çš„å·¥å…·ã€‚å®ƒæ”¯æŒé€šè¿‡ä¿®æ”¹Modelfileå®šåˆ¶æ¨¡å‹ï¼Œä¾‹å¦‚æ”¹å˜ç³»ç»Ÿæç¤ºè¯å’Œå‚æ•°ï¼Œæ¥åˆ›å»ºæ–°çš„æ¨¡å‹ç‰ˆæœ¬ã€‚è¿™å…è®¸ç”¨æˆ·æ ¹æ®ç‰¹å®šéœ€æ±‚å¿«é€Ÿç”Ÿæˆæ–°æ¨¡å‹ï¼Œä¾‹å¦‚ä¸€ä¸ªè¡¨ç°ä¸º5å²å­©å­çš„æ¨¡å‹ã€‚æ­¤å¤–ï¼ŒOllamaå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–RESTful APIé›†æˆåˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œæ”¯æŒä¸åŒç±»å‹çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬å¯¹è¯æ¨¡å‹ã€‚

Ollamaæ˜¯Macç”¨æˆ·åœ¨å¼€å‘å¤§æ¨¡å‹åº”ç”¨åŸå‹çš„æ—¶å€™ï¼Œéå¸¸ä¸é”™çš„é€‰æ‹©ã€‚
